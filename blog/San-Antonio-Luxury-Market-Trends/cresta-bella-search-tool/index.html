<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Primary Meta Tags -->
  <title>Luxury Homes in Cresta Bella (2025) | San Antonio Gated Community Guide</title>
  <meta name="title" content="Luxury Homes in Cresta Bella (2025) | San Antonio Gated Community Guide" />
  <meta name="description" content="Explore Cresta Bella—an upscale gated community perched above San Antonio. Discover luxury homes, scenic views, and high-end living minutes from The Rim and La Cantera." />

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://www.orionhomesearch.com/blog/San-Antonio-Luxury-Market-Trends/cresta-bella-search-tool" />
  <meta property="og:title" content="Cresta Bella Luxury Homes | San Antonio Real Estate (2025)" />
  <meta property="og:description" content="Discover premier listings in Cresta Bella—San Antonio’s hilltop haven for luxury buyers. Browse stunning homes with skyline views and gated serenity." />
  <meta property="og:image" content="https://images.pexels.com/photos/276724/pexels-photo-276724.jpeg" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:url" content="https://www.orionhomesearch.com/blog/San-Antonio-Luxury-Market-Trends/cresta-bella-search-tool" />
  <meta name="twitter:title" content="Cresta Bella Luxury Homes | San Antonio Real Estate (2025)" />
  <meta name="twitter:description" content="Tour luxury estates in Cresta Bella—skyline views, modern elegance, and gated living just off I-10. Search curated listings with Orion AI." />
  <meta name="twitter:image" content="https://images.pexels.com/photos/276724/pexels-photo-276724.jpeg" />

  <!-- Canonical URL -->
  <link rel="canonical" href="https://www.orionhomesearch.com/blog/San-Antonio-Luxury-Market-Trends/cresta-bella-search-tool" />

  <!-- Fonts and Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
 
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://www.orionhomesearch.com/images/favicon.png" />
  
  <!-- Google Tag Manager -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZF6721FNMD"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-ZF6721FNMD');
  </script>

  <!-- Buying Buddy Plugin -->
  <script src="https://www.mbb2.com/version3/css/theme/acid/iUGUuSwb"></script>
  <script>
    var MBB = { seo: "false", data: { acid: "iUGUuSwb" } };
    function mbbMapLoaded() { MBB.googleMaps = true; }
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?callback=mbbMapLoaded&libraries=places&key=AIzaSyBNolVKe1C5v2BZwPnNT7XvxXtYvlAs0ME"></script>
  <script src="https://d2w6u17ngtanmy.cloudfront.net/scripts/my-buying-buddy.5.0.js.gz"></script>
</head>

    <style>
      :root {
        --primary: #2a5b84;         /* Deep tech blue */
        --primary-light: #4b91c9;   /* Soft, clickable blue */
        --secondary: #b88cf3;       /* Muted violet, more AI elegance than neon */
        --accent: #5ef2c2;          /* Futuristic mint for hover effects or highlights */
        --dark: #1e1e2f;            /* Deep navy-charcoal for main background */
        --light: #f4f6f8;           /* Soft, breathable light background */
        --gray: #d1d5db;            /* Light cool gray for body text on dark */
        --white: #ffffff;
      }
      
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: 'Montserrat', sans-serif;
        color: var(--dark);
        line-height: 1.6;
        background-color: var(--white);
      }
      
      h1, h2, h3, h4 {
        font-family: 'Playfair Display', serif;
        font-weight: 700;
        margin-bottom: 1rem;
      }
      
      .container {
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }
      
      /* Header */
      header {
        background-color: var(--white);
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        position: fixed;
        width: 100%;
        z-index: 100;
        padding: 10px 0;
      }
      
      nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 15px;
      }
      
      .logo {
        font-size: 18px;
        font-weight: 700;
        color: var(--primary);
        white-space: nowrap;
      }
      
      .logo span {
        color: var(--secondary);
      }
      
      .menu-toggle {
        display: none;
        background: none;
        border: none;
        font-size: 1.5rem;
        color: var(--primary);
        cursor: pointer;
        z-index: 101;
      }
      
      .nav-links {
        display: flex;
        gap: 15px;
        align-items: center;
      }
      
      .nav-links a {
        text-decoration: none;
        color: var(--dark);
        font-weight: 500;
        transition: color 0.3s;
        font-size: 14px;
        display: inline-flex;
        align-items: center;
        gap: 5px;
      }
      
      .nav-links a:hover {
        color: var(--primary);
      }
      
      .cta-button {
        background-color: var(--primary);
        color: white;
        padding: 8px 12px;
        border-radius: 5px;
        font-weight: 600;
        transition: all 0.3s;
        font-size: 14px;
        border: none;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }
      
      .cta-button:hover {
        background-color: var(--primary-light);
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      }
      
      /* Mobile Menu Overlay */
      .mobile-menu-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
        backdrop-filter: blur(5px);
        z-index: 99;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }
      
      .mobile-menu-overlay.active {
        opacity: 1;
        visibility: visible;
      }
      
      /* Main Content */
      .main-content {
        padding: 120px 0 60px;
      }
      
      .page-title {
        text-align: center;
        margin-bottom: 40px;
      }
      
      .page-title h1 {
        font-size: 2.5rem;
        color: var(--primary);
      }
      
      .page-description {
        max-width: 800px;
        margin: 0 auto 40px;
        text-align: center;
      }
      
      .page-description p {
        color: #73a4d6;
      }
      
          /* Search Tools Container Styles */
          .search-toggle-container {
              width: 100%;
              max-width: none;
              display: flex;
              margin-bottom: 20px;
          }

          .search-toggle-btn {
              flex: 1;
              padding: 12px 15px;
              border: none;
              background: #f0f0f0;
              color: #333;
              font-weight: 600;
              cursor: pointer;
              transition: all 0.3s;
              text-align: center;
              font-size: 0.9rem;
          }
          
          .search-toggle-btn.active {
              background: #2a5b84; /* Primary color */
              color: white;
          }
          
          .search-toggle-btn:first-child {
              border-radius: 5px 0 0 5px;
          }
          
          .search-toggle-btn:last-child {
              border-radius: 0 5px 5px 0;
          }
          
          .search-container {
              display: none;
              margin-bottom: 30px;
          }
          
          .search-container.active {
              display: block;
          }
          
          #map-search-container {
              height: 500px;
              border-radius: 8px;
              overflow: hidden;
          }
      
      /* Map Preview */
      .map-preview {
        height: 350px;
        background-color: #eee;
        border-radius: 8px;
        margin-bottom: 20px;
        background-image: url('https://maps.googleapis.com/maps/api/staticmap?center=29.416013,-98.502827&zoom=12&size=800x350&maptype=roadmap&path=color:0x2a5b84|weight:5|fillcolor:0x5ef2c240|29.438440970486027,-98.47759324564198|29.439935931386533,-98.48583299173573|29.43305892897451,-98.49887925638417|29.41601391570481,-98.5028274680541|29.406892163929836,-98.51038056864003|29.396872247349016,-98.51192552103261|29.39388103611215,-98.4786232139037|29.402854405882685,-98.48136979593495|29.407938963911718,-98.47999650491933|29.42139686045126,-98.47999650491933|29.42767660219584,-98.48171311868886|29.438440970486027,-98.47759324564198&key=AIzaSyBNolVKe1C5v2BZwPnNT7XvxXtYvlAs0ME');
        background-size: cover;
        background-position: center;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      }
      
      /* CTA Section */
      .cta-section {
        padding: 80px 0;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        color: white;
        text-align: center;
        position: relative;
        overflow: hidden;
      }
      
      .cta-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: url('https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80') center/cover;
        opacity: 0.1;
        z-index: 0;
      }
      
      .cta-section .container {
        position: relative;
        z-index: 1;
      }
      
      .cta-section h2 {
        font-size: 2.5rem;
        margin-bottom: 20px;
      }
      
      .cta-section p {
        max-width: 700px;
        margin: 0 auto 30px;
        font-size: 1.1rem;
      }
      
      .cta-buttons {
        display: flex;
        gap: 15px;
        justify-content: center;
      }
      
      /* Updated Button Styles for CTA Section */
      .cta-section .cta-button,
      .cta-section .secondary-button {
        padding: 12px 25px;
        border-radius: 5px;
        font-weight: 600;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }
      
      .cta-section .cta-button {
        background-color: var(--primary);
        color: white;
        border: none;
      }
      
      .cta-section .cta-button:hover {
        background-color: var(--primary-light);
        transform: translateY(-2px);
        box-shadow: 0 8px 15px rgba(0,0,0,0.2);
      }
      
      .cta-section .secondary-button {
        background-color: transparent;
        color: white;
        border: 2px solid white;
      }
      
      .cta-section .secondary-button:hover {
        background-color: white;
        color: var(--primary);
        transform: translateY(-2px);
        box-shadow: 0 8px 15px rgba(0,0,0,0.2);
      }
      
      /* Contact Modal Styles */
      .contact-modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.6);
        animation: fadeIn 0.3s;
      }
      
      @keyframes fadeIn {
        from {opacity: 0;}
        to {opacity: 1;}
      }
      
      .modal-content {
        background-color: #fff;
        margin: 5% auto;
        padding: 30px;
        border-radius: 12px;
        max-width: 500px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 4px 12px rgba(0,0,0,0.25);
        animation: slideIn 0.3s;
      }
      
      @keyframes slideIn {
        from {transform: translateY(-50px); opacity: 0;}
        to {transform: translateY(0); opacity: 1;}
      }
      
      .close-modal {
        float: right;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
        transition: color 0.3s;
      }
      
      .close-modal:hover {
        color: var(--primary);
      }
      
      #contact-form .form-group {
          margin-bottom: 20px;
      }
      
      #contact-form label {
          display: block;
          margin-bottom: 8px;
          font-weight: 600;
      }
      
      #contact-form input,
      #contact-form select,
      #contact-form textarea {
          width: 100%;
          padding: 12px;
          border: 1px solid #ddd;
          border-radius: 5px;
          font-size: 16px;
          transition: border-color 0.3s;
      }
      
      #contact-form input:focus,
      #contact-form select:focus,
      #contact-form textarea:focus {
          border-color: var(--primary);
          outline: none;
          box-shadow: 0 0 0 2px rgba(42, 91, 132, 0.2);
      }
      
      /* Add this to your existing CSS */
      #contact-form button[type="submit"] {
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        color: white;
        border: none;
        padding: 15px 30px;
        font-size: 1.1rem;
        font-weight: 600;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(42, 91, 132, 0.3);
        text-transform: uppercase;
        letter-spacing: 1px;
        position: relative;
        overflow: hidden;
        width: 100%;
        margin-top: 20px;
      }
      
      #contact-form button[type="submit"]:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(42, 91, 132, 0.4);
        background: linear-gradient(135deg, var(--primary-light), var(--primary));
      }
      
      #contact-form button[type="submit"]:active {
        transform: translateY(1px);
      }
      
      /* Loading spinner animation */
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      #contact-form button[type="submit"] .fa-spinner {
        animation: spin 1s linear infinite;
        margin-right: 8px;
      }
      
      /* Checkboxes in form */
      .checkbox-group.after-text {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      
      .checkbox-inline {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.95rem;
        gap: 12px;
        padding: 4px 0;
      }

      /* Toggle button selections (for locations) */
      .toggle-option {
        padding: 10px;
        background: #f0f0f0;
        border: 1px solid #ccc;
      }

      .toggle-option.selected {
        background-color: #4caf50;
        color: white;
      }

      .checkbox-group label,
      .toggle-option {
        display: inline-block;
        margin: 10px 15px 10px 0; /* top right bottom left */
      }

      .checkbox-group {
        margin-bottom: 20px;
      }

      /* Success Popup */
      .success-popup {
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background-color: var(--white);
          padding: 30px;
          border-radius: 10px;
          box-shadow: 0 5px 30px rgba(0,0,0,0.3);
          z-index: 2000;
          text-align: center;
          max-width: 400px;
          display: none;
      }
      
      .success-popup i {
          font-size: 3rem;
          color: #4CAF50;
          margin-bottom: 20px;
      }
      
      .success-popup h3 {
          color: var(--primary);
          margin-bottom: 15px;
      }
      
      .success-popup p {
          margin-bottom: 20px;
      }
      
      .success-popup .close-popup {
          background-color: var(--primary);
          color: white;
          border: none;
          padding: 10px 20px;
          border-radius: 5px;
          cursor: pointer;
          transition: background-color 0.3s;
      }
      
      .success-popup .close-popup:hover {
          background-color: var(--primary-light);
      }
      
      .popup-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0,0,0,0.7);
          z-index: 1999;
          display: none;
      }
      
      /* Footer with Transparent Background */
      footer {
        background-color: var(--dark);
        color: white;
        padding: 50px 0 20px;
        text-align: center;
        position: relative;
      }

      footer:before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: url('https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80') center/cover;
        opacity: 0.05;
        z-index: 0;
      }

      footer .container {
        position: relative;
        z-index: 1;
      }

      .footer-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 30px;
        margin-bottom: 40px;
        text-align: left;
      }

      .footer-about {
        max-width: 400px;
      }

      .footer-logo {
        font-size: 24px;
        font-weight: 700;
        margin-bottom: 20px;
        display: block;
        color: var(--white);
      }

      .footer-logo span {
        color: var(--secondary);
      }

      .footer-about h3 {
        color: var(--secondary);
        margin-bottom: 20px;
        font-size: 1.2rem;
      }

      .footer-about p {
        margin-bottom: 20px;
      }

      .footer-links h3 {
        color: var(--secondary);
        margin-bottom: 20px;
        font-size: 1.2rem;
      }

      .footer-links {
        padding-left: 100px; /* Increase this value for more right spacing */
      }

      .footer-links ul {
        list-style: none;
      }

      .footer-links li {
        margin-bottom: 10px;
      }

      .footer-links a {
        color: white;
        text-decoration: none;
        transition: color 0.3s;
      }

      .footer-links a:hover {
        color: var(--accent);
      }

      .footer-contact h3 {
        color: var(--secondary);
        margin-bottom: 20px;
        font-size: 1.2rem;
      }

      .footer-contact p {
        margin-bottom: 5px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .footer-contact i {
        color: var(--accent);
        width: 20px;
      }

      .social-links {
        display: flex;
        gap: 15px;
        margin-top: 20px;
        justify-content: flex-start;
      }

      .social-links a {
        color: white;
        font-size: 1.2rem;
        transition: all 0.3s;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: rgba(255,255,255,0.1);
      }

      .social-links a:hover {
        color: var(--secondary);
        background-color: rgba(255,255,255,0.2);
        transform: translateY(-3px);
      }

      .copyright {
        text-align: center;
        padding-top: 20px;
        border-top: 1px solid rgba(255,255,255,0.1);
        font-size: 0.9rem;
        opacity: 0.8;
      }
      
      /* Calculator Styles */
      .calculator {
          padding: 40px 0;
          background-color: var(--white);
      }
      
      .calculator-toggle {
          display: flex;
          justify-content: center;
          margin-bottom: 15px;
      }
      
      .calculator-toggle button {
          border-radius: 0;
          margin: 0;
          padding: 8px 16px;
          font-size: 1rem;
      }
      
      .calculator-toggle button:first-child {
          border-radius: 5px 0 0 5px;
      }
      
      .calculator-toggle button:last-child {
          border-radius: 0 5px 5px 0;
      }
      
      .calculator-container {
          display: flex;
          flex-wrap: wrap;
          gap: 18px;
          background-color: var(--white);
          border-radius: 10px;
          box-shadow: 0 5px 15px rgba(0,0,0,0.05);
          padding: 18px;
          max-width: 700px;
          margin: 0 auto;
      }
      
      .calculator-form {
          flex: 1;
          min-width: 210px;
          padding: 10px;
      }
      
      .calculator-results {
          flex: 1;
          min-width: 210px;
          gap: 10px;
          display: flex;
          flex-direction: column;
      }
      
      .form-group {
          margin-bottom: 10px;
      }
      
      .form-group label {
          display: block;
          margin-bottom: 4px;
          font-weight: 500;
          font-size: 0.98rem;
      }
      
      .form-group input,
      .form-group select {
          width: 100%;
          padding: 7px 10px;
          border: 1px solid #ddd;
          border-radius: 5px;
          font-size: 15px;
      }
      
      .result-card {
          background-color: var(--light);
          padding: 10px;
          border-radius: 8px;
          margin-bottom: 8px;
          text-align: center;
      }
      
      .result-card h3 {
          font-size: 0.95rem;
          margin-bottom: 4px;
          color: var(--primary);
      }
      
      .result-amount {
          font-size: 1.15rem;
          font-weight: 700;
          color: var(--primary);
      }
      
      .result-breakdown {
          background-color: var(--light);
          padding: 10px;
          border-radius: 8px;
      }
      
      .result-breakdown h4 {
          font-size: 0.98rem;
          margin-bottom: 7px;
          color: var(--primary);
      }
      
      .breakdown-item {
          display: flex;
          justify-content: space-between;
          padding: 5px 0;
          border-bottom: 1px solid #eee;
          font-size: 0.97rem;
      }
      
      .breakdown-item.total {
          font-weight: 600;
          border-bottom: none;
          padding-top: 8px;
      }
      
      @media (max-width: 768px) {
      .search-toggle-btn {
          padding: 10px 8px;
          font-size: 0.8rem;
      }
      #map-search-container {
          height: 400px;
      }
      
      .footer-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: 30px;
      }
    
      .footer-about,
      .footer-links,
      .footer-contact {
        padding: 0;
        text-align: center;
        width: 100%;
        max-width: 300px;
      }
    
      .footer-links {
        padding-left: 0;
      }
    
      .footer-links ul {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 0;
      }
    
      .footer-links li {
        text-align: center;
      }
    
      .social-links {
        justify-content: center;
      }

      /* Added styles to center contact info */
      .footer-contact {
        text-align: center;
        margin-top: 30px;
      }
      
      .footer-contact p {
        justify-content: center;
        margin-bottom: 15px;
      }
        
        .main-content {
          padding: 100px 0 40px;
        }
        
        .page-title h1 {
          font-size: 2rem;
        }
        
        .menu-toggle {
          display: block;
        }
        
        .nav-links {
          position: fixed;
          top: 60px;
          left: 0;
          width: 100%;
          background-color: var(--white);
          flex-direction: column;
          align-items: center;
          padding: 20px 0;
          gap: 15px;
          box-shadow: 0 5px 10px rgba(0,0,0,0.1);
          transform: translateY(-150%);
          transition: transform 0.3s ease-in-out;
          z-index: 100;
        }
        
        .nav-links.active {
          transform: translateY(0);
        }
        
        .logo {
          font-size: 16px;
        }
        
        .map-preview {
          height: 250px;
        }
        
        .cta-buttons {
          flex-direction: column;
          align-items: center;
        }
        
        .cta-section .cta-button,
        .cta-section .secondary-button {
          width: 100%;
          max-width: 250px;
        }

        /* Add or update these styles for a cleaner, more compact calculator */
        .calculator .container {
          max-width: 820px;
          margin: 0 auto;
          padding: 0 10px;
        }
        .calculator-flex-wrap {
          display: flex;
          flex-direction: column;
          align-items: center;
        }
        .calculator-container {
          width: 100%;
          max-width: 700px;
          margin: 0 auto 20px auto;
          display: flex;
          flex-wrap: wrap;
          gap: 16px;
          background-color: var(--white);
          border-radius: 10px;
          box-shadow: 0 3px 10px rgba(0,0,0,0.06);
          padding: 12px;
        }
        .calculator-form, .calculator-results {
          flex: 1 1 240px;
          min-width: 180px;
          padding: 6px;
        }
        .calculator-form {
          max-width: 270px;
        }
        .calculator-results {
          max-width: 320px;
          gap: 8px;
          display: flex;
          flex-direction: column;
        }
        .form-group label {
          font-size: 0.97rem;
        }
        .form-group input, .form-group select {
          font-size: 15px;
          padding: 6px 8px;
        }
        .result-card {
          padding: 8px;
          margin-bottom: 6px;
        }
        .result-card h3 {
          font-size: 1rem;
        }
        .result-amount {
          font-size: 1.18rem;
        }
        .result-breakdown {
          padding: 8px;
        }
        .result-breakdown h4 {
          font-size: 0.97rem;
          margin-bottom: 6px;
        }
        .breakdown-item {
          font-size: 0.96rem;
          padding: 4px 0;
        }
        .breakdown-item.total {
          padding-top: 6px;
        }
          
      @media (max-width: 900px) {
        .calculator .container, .calculator-container {
          max-width: 98vw;
        }
        .calculator-flex-wrap {
          flex-direction: column;
          align-items: stretch;
        }
        .calculator-container {
          flex-direction: column;
          gap: 8px;
          padding: 8px;
        }
        .calculator-form, .calculator-results {
          max-width: 100%;
          min-width: 0;
          padding: 0;
        }  
      }
    </style>
  </head>
  <body>
    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobile-overlay"></div>

  <!-- Header -->
  <header>
    <div class="container">
      <nav>
        <div class="logo">
          <span>Orion</span> — AI Powered Home Search
        </div>
        <button class="menu-toggle" id="mobile-menu">
          <i class="fas fa-bars"></i>
        </button>
        <div class="nav-links" id="nav-links">
          <a href="https://www.orionhomesearch.com/"><i class="fas fa-home"></i> Home</a>
          <a href="https://www.orionhomesearch.com/"><i class="fa-solid fa-list"></i> Home Search Tool</a>
          <a href="https://www.orionhomesearch.com/blog"><i class="fas fa-blog"></i> Blog</a>
          <a href="#contact" class="cta-button"><i class="fas fa-user-astronaut"></i> Match Me With a Trusted Agent</a>
          <a href="#footer" class="exp-logo-button" title="Brokered by eXp Realty">
            <span class="brokered-text"><b>Brokered by</b></span>
            <img src="https://www.orionhomesearch.com/images/exp-realty.png" alt="eXp Realty" style="height: 25px;"> 
          </a>
          </div>
        </div>
      </nav>
    </div>
  </header>

    <!-- Main Content -->
    <main class="main-content">
      <div class="container">
        <div class="page-title">
          <h1>Luxury Homes in Cresta Bella</h1>
        </div>
        
        <div class="page-description">
          <p>EExplore upscale listings in Cresta Bella—San Antonio’s premier gated community perched above the city skyline. These luxury homes offer modern architecture, breathtaking views, and elite access to The Rim, La Cantera, and I-10. Listings below are AI-sorted by price for smart comparison.</p>
        </div>
        
 <!-- Property Search Section -->
      <section id="listings">
              
              <!-- Three Toggle Buttons -->
              <div class="search-toggle-container">
                  <button class="search-toggle-btn active" data-target="featured-container">Featured Listings</button>
                  <button class="search-toggle-btn" data-target="form-search-container">Form Search</button>
                  <button class="search-toggle-btn" data-target="map-search-container">Map View</button>
              </div>
              
              <!-- Featured Listings Container (default visible) -->
              <div id="featured-container" class="search-container active">
                  <div id="MBBv3_FeaturedGallery" filter="mls_id:tx521+listing_status:active+prop_img:true+bedrooms_total_min:1+sub_area:Cresta Bella+representation_type:any_listing+limit:12+order:create_dt desc"></div>
              </div>

              <!-- Form Search Container -->
              <div id="form-search-container" class="search-container">
                  <div id="MBBv3_SearchForm" filter="mls_id:tx521+listing_status:active+prop_img:true+bedrooms_total_min:1+representation_type:any_listing"></div>
              </div>
              
              <!-- Map Search Container -->
              <div id="map-search-container" class="search-container">
                  <div id="MBBv3_InteractiveMap" filter="mls_id:tx521+listing_status:active+prop_img:true+bedrooms_total_min:1+sub_area:Cresta Bella+representation_type:any_listing+limit:12+order:create_dt desc"></div>
              </div>
      </section>

    <!-- Mortgage Calculator Section -->
      <section class="calculator">
          <div class="container">
            <div class="page-title">
              <h1>Financial Calculators</h1>
            </div>
            <div class="page-description">
              <p>Estimate your monthly payments or calculate your debt-to-income ratio.</p>
            </div>
            <div class="calculator-toggle">
              <button id="mortgage-toggle" class="cta-button">Mortgage Calculator</button>
              <button id="dti-toggle" class="secondary-button">Debt-to-Income Calculator</button>
            </div>
            <div class="calculator-flex-wrap">
              <!-- Mortgage Calculator (initially visible) -->
              <div class="calculator-container" id="mortgage-calculator">
                <div class="calculator-form">
                  <div class="form-group">
                    <label for="home-price">Home Price ($)</label>
                    <input type="number" id="home-price" value="300000" min="50000" step="10000">
                  </div>
                  <div class="form-group">
                    <label for="down-payment">Down Payment ($)</label>
                    <input type="number" id="down-payment" value="100000" min="0" step="5000">
                  </div>
                  <div class="form-group">
                    <label for="loan-term">Loan Term (years)</label>
                    <select id="loan-term">
                      <option value="30">30 years</option>
                      <option value="20">20 years</option>
                      <option value="15">15 years</option>
                      <option value="10">10 years</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="interest-rate">Interest Rate (%)</label>
                    <input type="number" id="interest-rate" value="5.5" min="1" max="20" step="0.125">
                  </div>
                  <div class="form-group">
                    <label for="property-tax-rate">Property Tax Rate (%)</label>
                    <input type="number" id="property-tax-rate" value="1.8" min="0.5" max="5" step="0.1">
                  </div>
                  <div class="form-group">
                    <label for="insurance-rate">Home Insurance Rate (%)</label>
                    <input type="number" id="insurance-rate" value="0.5" min="0.1" max="2" step="0.1">
                  </div>
                  <div class="form-group">
                    <label for="hoa-fee">Monthly HOA Fee ($)</label>
                    <input type="number" id="hoa-fee" value="100" min="0" step="25">
                  </div>
                  <button id="calculate-btn" class="cta-button" style="width:100%;">Calculate Payment</button>
                </div>
                <div class="calculator-results">
                  <div class="result-card">
                    <h3>Monthly Payment</h3>
                    <div class="result-amount" id="monthly-payment">$0</div>
                  </div>
                  <div class="result-card">
                    <h3>Total Interest</h3>
                    <div class="result-amount" id="total-interest">$0</div>
                  </div>
                  <div class="result-card">
                    <h3>Total Cost</h3>
                    <div class="result-amount" id="total-cost">$0</div>
                  </div>
                  <div class="result-breakdown">
                    <h4>Payment Breakdown</h4>
                    <div class="breakdown-item">
                      <span>Principal & Interest</span>
                      <span id="principal-interest">$0</span>
                    </div>
                    <div class="breakdown-item">
                      <span>Property Tax</span>
                      <span id="property-tax">$0</span>
                    </div>
                    <div class="breakdown-item">
                      <span>Home Insurance</span>
                      <span id="home-insurance">$0</span>
                    </div>
                    <div class="breakdown-item">
                      <span>HOA Fee</span>
                      <span id="hoa-fee-display">$0</span>
                    </div>
                    <div class="breakdown-item total">
                      <span>Total Monthly Payment</span>
                      <span id="total-monthly">$0</span>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Debt-to-Income Calculator (initially hidden) -->
              <div class="calculator-container" id="dti-calculator" style="display: none;">
                <div class="calculator-form">
                  <div class="form-group">
                    <label for="monthly-income">Monthly Gross Income ($)</label>
                    <input type="number" id="monthly-income" value="6000" min="1000" step="500">
                  </div>
                  <div class="form-group">
                    <label for="monthly-debts">Monthly Debt Payments ($)</label>
                    <input type="number" id="monthly-debts" value="1000" min="0" step="100">
                  </div>
                  <div class="form-group">
                    <label for="proposed-mortgage">Proposed Mortgage Payment ($)</label>
                    <input type="number" id="proposed-mortgage" value="1500" min="0" step="100">
                  </div>
                  <button id="calculate-dti-btn" class="cta-button" style="width:100%;">Calculate DTI Ratio</button>
                </div>
                <div class="calculator-results">
                  <div class="result-card">
                    <h3>Front-End Ratio</h3>
                    <div class="result-amount" id="front-end-ratio">0%</div>
                    <p style="font-size:0.9em;">(Mortgage ÷ Income)</p>
                  </div>
                  <div class="result-card">
                    <h3>Back-End Ratio</h3>
                    <div class="result-amount" id="back-end-ratio">0%</div>
                    <p style="font-size:0.9em;">(Debts + Mortgage ÷ Income)</p>
                  </div>
                  <div class="result-card">
                    <h3>Lender Preference</h3>
                    <div class="result-amount" id="lender-preference">-</div>
                    <p style="font-size:0.9em;">(Based on typical standards)</p>
                  </div>
                  <div class="result-breakdown">
                    <h4>DTI Guidelines</h4>
                    <div class="breakdown-item">
                      <span>Ideal Front-End Ratio</span>
                      <span>≤ 28%</span>
                    </div>
                    <div class="breakdown-item">
                      <span>Ideal Back-End Ratio</span>
                      <span>≤ 36%</span>
                    </div>
                    <div class="breakdown-item">
                      <span>Maximum Back-End Ratio</span>
                      <span>≤ 43% (typical)</span>
                    </div>
                    <div class="breakdown-item total">
                      <span>Your Back-End Ratio</span>
                      <span id="your-back-end">0%</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
      </section>
    </main>

    <!-- CTA Section -->
    <section class="cta-section" id="contact">
      <div class="container">
        <h2>Ready to Begin Your Search?</h2>
        <p>The best homes don't wait—and neither should you. Orion is here to accelerate your journey, answer your questions, and guide you with clarity. No pressure. Just precision, insight, and honest help.</p>
        <div class="cta-buttons">
          <button id="contact-btn" class="cta-button"><i class="fas fa-user-astronaut"></i> Match Me With a Trusted Agent</button>
        </div>
      </div>
    </section>

    <!-- Contact Modal -->
    <div id="contact-modal" class="contact-modal">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2 style="margin-bottom: 20px;">Let's Connect</h2>
        <p style="margin-bottom: 20px;">Tell us about your real estate needs and we'll get back to you within 24 hours.</p>
        
        <form id="contact-form" method="POST" action="https://script.google.com/macros/s/AKfycbw30mh3WRB_BsQo4o2Y9INBD7IKsEVxYdUwOsj2VE6eP5aCpU17zTFqeM8ao7sMm7VDqQ/exec">
        <!-- Full Name -->
        <div class="form-group">
            <label for="fullName">Full Name</label>
            <input type="text" id="fullName" name="fullName" required>
        </div>
        
        <!-- Email -->
        <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" name="email" required>
        </div>
        
        <!-- Phone Number -->
        <div class="form-group">
            <label for="phone">Phone Number</label>
            <input type="tel" id="phone" name="phone" required>
        </div>
        
        <!-- Preferred Military Base Assignments -->
        <div class="form-group">
          <label>Which Base Are You PCSing To?</label>
          <div class="toggle-group">
            <button type="button" class="toggle-option" data-value="Lackland AFB">Lackland AFB Families</button>
            <button type="button" class="toggle-option" data-value="Fort Sam Houston">Fort Sam Houston Medical Corps</button>
            <button type="button" class="toggle-option" data-value="Randolph AFB">Randolph AFB Aviators</button>
            <button type="button" class="toggle-option" data-value="Other">Other</button>
          </div>
          <input type="hidden" name="locations" id="selectedLocations">
        </div>
        
        <!-- Timeline -->
        <div class="form-group">
            <label for="timeline">Timeline to Move</label>
            <select id="timeline" name="timeline" required>
            <option value="">Select</option>
            <option value="ASAP">ASAP</option>
            <option value="1-3 Months">0-3 Months</option>
            <option value="3-6 Months">3-6 Months</option>
            <option value="6-12 Months">6-12 Months</option>
            <option value="More than 12 Months">More than 12 Months</option>
            </select>
        </div>
        
        <!-- Budget -->
        <div class="form-group">
            <label for="budget">Budget Range</label>
            <select id="budget" name="budget" required>
            <option value="">Select</option>
            <option value="Under $200k">Under $200k</option>
            <option value="$200k - $300k">$200k - $350k</option>
            <option value="$300k - $400k">$350k - $500k</option>
            <option value="$500k+">$500k+</option> 
            </select>
        </div>
        
        <!-- Pre-Approval -->
        <div class="form-group">
            <label for="preapproval">Have you been pre-approved by a lender?</label>
            <select id="preapproval" name="preapproval" required>
            <option value="">Select</option>
            <option value="Yes">Yes</option>
            <option value="Not yet, but planning to">Not yet, but planning to</option>
            <option value="No">No</option>
            </select>
        </div>
        
        <!-- Buyer Type -->
        <div class="form-group">
            <label for="buyerType">What best describes you?</label>
            <select id="buyerType" name="buyerType" required>
            <option value="">Select</option>
            <option value="First-time homebuyer">First-time homebuyer</option>
            <option value="Investor">Investor</option>
            <option value="Relocating from out of state">Relocating from out of state</option>
            <option value="Looking to upgrade">Looking to upgrade</option>
            <option value="Military or Veteran">Military or Veteran</option>
            </select>
        </div>
        
        <!-- Financing Plan -->
        <div class="form-group">
            <label for="financingPlan">How do you plan to finance your home?</label>
            <select id="financingPlan" name="financingPlan" required>
            <option value="">Select</option>
            <option value="Conventional loan">Conventional loan</option>
            <option value="VA loan">VA loan</option>
            <option value="FHA loan">FHA loan</option>
            <option value="Cash">Cash</option>
            <option value="Not sure yet">Not sure yet</option>
            </select>
        </div>

        <!-- Updated Terms of Service Toggle -->
        <div class="form-group">
            <label style="display: block; font-weight: 600;">Consent Required</label>
            <button type="button" id="termsToggle" class="toggle-option" data-agreed="false">
            I agree to the <a href="https://www.orionhomesearch.com/Terms%20of%20Service.txt" target="_blank" style="color: inherit; text-decoration: underline;">Terms of Service</a>
            </button>
            <input type="hidden" name="terms" id="termsAgreed" value="">
            <p style="font-size: 0.8rem; margin-top: 5px;">You must agree before submitting.</p>
        </div>

        <!-- Added communication consent text -->
        <p style="font-size: 0.8rem; margin-top: -10px; margin-bottom: 10px;">
            By submitting this form, you agree to receive communications by email, phone, or text from Orion AI Real Estate. You may opt out at any time.
        </p>
        
        <button type="submit">Send Message <i class="fas fa-paper-plane"></i></button>
        <div id="successMessage" style="display:none; margin-top: 1em; color: green; font-weight: bold;">
            Thank you! Your form has been submitted.
        </div>
        </form>
    </div>
    </div>

    <!-- Success Popup -->
    <div class="popup-overlay" id="popup-overlay"></div>
    <div class="success-popup" id="success-popup">
        <i class="fas fa-check-circle"></i>
        <h3>Form Submitted Successfully!</h3>
        <p>Thank you for your submission. We'll get back to you soon.</p>
        <button class="close-popup" id="close-popup">Close</button>
    </div>
    
  <!-- Footer with Transparent Background -->
  <footer id="footer">
    <div class="container">
      <div class="footer-container">
        <div class="footer-about">
          <div class="footer-logo"><span>Orion</span> Where AI Meets Home.</div>
          <h3>Helping You Find Your Perfect Home</h3>
          <p>Powered by AI precision and human insight, we help you navigate San Antonio's real estate market with confidence.</p>
        </div>
  
        <div class="footer-links">
          <h3>Quick Links</h3>
          <ul>
            <li><a href="https://www.orionhomesearch.com/blog"><i class="fas fa-blog"></i> Blog</a></li>
            <li><a href="https://www.orionhomesearch.com/First Time Homebuyers Guide.docx" download><i class="fas fa-satellite-dish"></i> Buyer's Intel</a></li>
            <li><a href="https://www.orionhomesearch.com/docs/CPN.pdf" target="_blank"><i class="fas fa-shield-alt"></i> TREC Consumer Protection Notice</a></li>
            <li><a href="https://www.orionhomesearch.com/docs/IABS.pdf" target="_blank"><i class="fas fa-id-card-alt"></i> TREC Information About Brokerage Services</a></li>
            <li><a href="https://www.orionhomesearch.com/docs/privacy-policy.txt" target="_blank><i class="fas fa-user-shield"></i> Privacy Policy</a></li>
            <li><a href="https://www.orionhomesearch.com/docs/disclaimer.txt" target="_blank><i class="fas fa-exclamation-circle"></i> Real Estate Disclaimer</a></li>
          </ul>
        </div>
  
        <div class="footer-contact">
          <h3>Contact Information</h3>
  
          <p style="margin-top: 20px;"><i class="fas fa-user"></i> Sanhenry Garcia</p>
          <p><i class="fas fa-phone"></i> 210-608-3275</p>
          <p><i class="fas fa-envelope"></i> sanhenry.garcia@exprealty.com</p>
  	
          <p style="margin-top: 40px;"><i class="fas fa-building"></i> eXp Realty in San Antonio</p>
          <p><i class="fas fa-map-pin"></i> 17806 IH 10, Ste. 300</p>
          <p><i class="fas fa-map-pin"></i> San Antonio, TX 78257</p>
          <p><i class="fas fa-phone"></i> 888-519-7431</p>
        </div>
      </div>

      <div class="copyright">
        <p>&copy; 2025 Orion AI. A legacy guided by intelligence.</p>
        <p style="margin-top: 10px; font-size: 0.8em; opacity: 0.7;">
          This website uses cookies and third-party tools (e.g., Google Analytics) to improve your experience.
        </p>
      <div id="MBBv3_Disclaimer" style="--bbw-disclaimer-bg-color-rgba:29,29,45,0;--bbw-body-text-color:#ffffffff;--bbw-disclaimer-bg-border-radius:0"></div>
      </div>
    </div>
  </footer>
    
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // Three-button toggle functionality for property search
        const toggleButtons = document.querySelectorAll('.search-toggle-btn');
        const searchContainers = document.querySelectorAll('.search-container');

        toggleButtons.forEach(button => {
          button.addEventListener('click', function() {
            // Remove active class from all buttons
            toggleButtons.forEach(btn => btn.classList.remove('active'));
            
            // Add active class to clicked button
            this.classList.add('active');
            
            // Get target container ID
            const targetId = this.getAttribute('data-target');
            
            // Hide all containers
            searchContainers.forEach(container => {
              container.classList.remove('active');
            });
            
            // Show target container
            const targetContainer = document.getElementById(targetId);
            if (targetContainer) {
              targetContainer.classList.add('active');
            }
          });
        });

        // Mobile menu functionality
        const mobileMenu = document.getElementById('mobile-menu');
        const navLinks = document.getElementById('nav-links');
        const mobileOverlay = document.getElementById('mobile-overlay');
        if (mobileMenu && navLinks && mobileOverlay) {
          mobileMenu.addEventListener('click', function () {
            navLinks.classList.toggle('active');
            mobileOverlay.classList.toggle('active');
            if (navLinks.classList.contains('active')) {
              mobileMenu.innerHTML = '<i class="fas fa-times"></i>';
            } else {
              mobileMenu.innerHTML = '<i class="fas fa-bars"></i>';
            }
          });
          mobileOverlay.addEventListener('click', function () {
            navLinks.classList.remove('active');
            mobileOverlay.classList.remove('active');
            mobileMenu.innerHTML = '<i class="fas fa-bars"></i>';
          });
          document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', function () {
              navLinks.classList.remove('active');
              mobileOverlay.classList.remove('active');
              mobileMenu.innerHTML = '<i class="fas fa-bars"></i>';
            });
          });
        }

        // Contact Modal Functionality
        const contactBtn = document.getElementById('contact-btn');
        const modal = document.getElementById('contact-modal');
        const closeBtn = document.querySelector('.close-modal');
        const successPopup = document.getElementById('success-popup');
        const popupOverlay = document.getElementById('popup-overlay');

        if (contactBtn && modal && closeBtn) {
          contactBtn.addEventListener('click', function () {
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
          });
          closeBtn.addEventListener('click', function () {
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
          });
          window.addEventListener('click', function (e) {
            if (e.target === modal) {
              modal.style.display = 'none';
              document.body.style.overflow = 'auto';
            }
          });
        }

        // Location toggle buttons
        const locationButtons = document.querySelectorAll('.toggle-group .toggle-option');
        const selectedLocations = document.getElementById('selectedLocations');
        locationButtons.forEach(button => {
          button.addEventListener('click', function () {
            this.classList.toggle('selected');
            updateSelectedLocations();
          });
        });
        function updateSelectedLocations() {
          const selected = Array.from(locationButtons)
            .filter(btn => btn.classList.contains('selected'))
            .map(btn => btn.dataset.value);
          selectedLocations.value = selected.join(', ');
        }

        // Terms toggle
        const termsToggle = document.getElementById('termsToggle');
        const termsAgreed = document.getElementById('termsAgreed');
        if (termsToggle && termsAgreed) {
          termsToggle.addEventListener('click', function () {
            const agreed = this.getAttribute('data-agreed') === 'true';
            this.setAttribute('data-agreed', !agreed);
            this.classList.toggle('selected');
            termsAgreed.value = !agreed ? 'agreed' : '';
          });
        }

         // Form submission with success popup
            const contactForm = document.getElementById('contact-form');
        
            contactForm.addEventListener('submit', function(e) {
                e.preventDefault();
        
                // Validate terms agreement
                if (termsAgreed.value !== 'agreed') {
                    alert('Please agree to the Terms of Service before submitting.');
                    return;
                }
        
                const submitBtn = contactForm.querySelector('button[type="submit"]');
                const originalText = submitBtn.innerHTML;
        
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
        
                // Prepare form data
                const formData = new FormData(contactForm);
                
                // Add security token to the form data
                formData.append('securityToken', 'xTk9F#2pLq$8zRn!7vYw*5sBm@4dGc%1hJ'); // Same token as in Apps Script
        
                fetch(contactForm.action, {
                    method: 'POST',
                    body: new URLSearchParams(formData),
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    }
                })
                .then(response => {
                    if (!response.ok) throw new Error('Network response was not ok');
                    return response.json();
                })
                .then(data => {
                    if (data.result === "error") {
                        throw new Error(data.message);
                    }
                    
                    // Show success popup
                    successPopup.style.display = 'block';
                    popupOverlay.style.display = 'block';
                    document.body.style.overflow = 'hidden';
        
                    // Reset form
                    contactForm.reset();
        
                    // Reset location selections
                    locationButtons.forEach(btn => btn.classList.remove('selected'));
                    selectedLocations.value = '';
        
                    // Reset terms agreement
                    termsToggle.classList.remove('selected');
                    termsToggle.setAttribute('data-agreed', 'false');
                    termsAgreed.value = '';
        
                    // Close the modal
                    modal.style.display = 'none';
                })
                .catch(error => {
                    alert('There was an error submitting the form: ' + error.message);
                    console.error('Error:', error);
                })
                .finally(() => {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalText;
                });
            });
        
            // Close popup handlers
            document.getElementById('close-popup')?.addEventListener('click', () => {
                successPopup.style.display = 'none';
                popupOverlay.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
        
            popupOverlay?.addEventListener('click', () => {
                successPopup.style.display = 'none';
                popupOverlay.style.display = 'none';
                document.body.style.overflow = 'auto';
            });

        // Calculator toggle functionality
        const mortgageToggle = document.getElementById('mortgage-toggle');
        const dtiToggle = document.getElementById('dti-toggle');
        const mortgageCalc = document.getElementById('mortgage-calculator');
        const dtiCalc = document.getElementById('dti-calculator');
        if (mortgageToggle && dtiToggle && mortgageCalc && dtiCalc) {
          mortgageToggle.addEventListener('click', function () {
            mortgageCalc.style.display = 'flex';
            dtiCalc.style.display = 'none';
            mortgageToggle.classList.add('cta-button');
            mortgageToggle.classList.remove('secondary-button');
            dtiToggle.classList.add('secondary-button');
            dtiToggle.classList.remove('cta-button');
          });
          dtiToggle.addEventListener('click', function () {
            mortgageCalc.style.display = 'none';
            dtiCalc.style.display = 'flex';
            dtiToggle.classList.add('cta-button');
            dtiToggle.classList.remove('secondary-button');
            mortgageToggle.classList.add('secondary-button');
            mortgageToggle.classList.remove('cta-button');
          });
        }

        // Mortgage Calculator functionality
        const calculateBtn = document.getElementById('calculate-btn');
        if (calculateBtn) {
          calculateBtn.addEventListener('click', calculateMortgage);
        }
        const mortgageInputs = document.querySelectorAll('#mortgage-calculator input, #mortgage-calculator select');
        mortgageInputs.forEach(input => {
          input.addEventListener('change', calculateMortgage);
          input.addEventListener('keyup', calculateMortgage);
        });
        function calculateMortgage() {
          const homePrice = parseFloat(document.getElementById('home-price').value) || 0;
          const downPayment = parseFloat(document.getElementById('down-payment').value) || 0;
          const loanTerm = parseInt(document.getElementById('loan-term').value) || 30;
          const interestRate = parseFloat(document.getElementById('interest-rate').value) || 0;
          const propertyTaxRate = parseFloat(document.getElementById('property-tax-rate').value) || 0;
          const insuranceRate = parseFloat(document.getElementById('insurance-rate').value) || 0;
          const hoaFee = parseFloat(document.getElementById('hoa-fee').value) || 0;
          const loanAmount = homePrice - downPayment;
          const monthlyInterestRate = interestRate / 100 / 12;
          const numberOfPayments = loanTerm * 12;
          let monthlyPayment = 0;
          if (monthlyInterestRate > 0 && numberOfPayments > 0) {
            monthlyPayment = loanAmount *
              (monthlyInterestRate * Math.pow(1 + monthlyInterestRate, numberOfPayments)) /
              (Math.pow(1 + monthlyInterestRate, numberOfPayments) - 1);
          }
          const monthlyPropertyTax = (homePrice * (propertyTaxRate / 100)) / 12;
          const monthlyInsurance = (homePrice * (insuranceRate / 100)) / 12;
          const totalMonthlyPayment = monthlyPayment + monthlyPropertyTax + monthlyInsurance + hoaFee;
          const totalInterest = (monthlyPayment * numberOfPayments) - loanAmount;
          const totalCost = homePrice + totalInterest + (monthlyPropertyTax * numberOfPayments) +
            (monthlyInsurance * numberOfPayments) + (hoaFee * numberOfPayments);
          document.getElementById('monthly-payment').textContent = formatCurrency(totalMonthlyPayment);
          document.getElementById('total-interest').textContent = formatCurrency(totalInterest);
          document.getElementById('total-cost').textContent = formatCurrency(totalCost);
          document.getElementById('principal-interest').textContent = formatCurrency(monthlyPayment);
          document.getElementById('property-tax').textContent = formatCurrency(monthlyPropertyTax);
          document.getElementById('home-insurance').textContent = formatCurrency(monthlyInsurance);
          document.getElementById('hoa-fee-display').textContent = formatCurrency(hoaFee);
          document.getElementById('total-monthly').textContent = formatCurrency(totalMonthlyPayment);
        }

        // DTI Calculator functionality
        const calculateDtiBtn = document.getElementById('calculate-dti-btn');
        if (calculateDtiBtn) {
          calculateDtiBtn.addEventListener('click', calculateDTI);
        }
        const dtiInputs = document.querySelectorAll('#dti-calculator input');
        dtiInputs.forEach(input => {
          input.addEventListener('change', calculateDTI);
          input.addEventListener('keyup', calculateDTI);
        });
        function calculateDTI() {
          const monthlyIncome = parseFloat(document.getElementById('monthly-income').value) || 0;
          const monthlyDebts = parseFloat(document.getElementById('monthly-debts').value) || 0;
          const proposedMortgage = parseFloat(document.getElementById('proposed-mortgage').value) || 0;
          const frontEndRatio = (proposedMortgage / monthlyIncome) * 100;
          const backEndRatio = ((monthlyDebts + proposedMortgage) / monthlyIncome) * 100;
          let lenderPreference = 'Poor';
          if (backEndRatio <= 36) {
            lenderPreference = 'Excellent';
          } else if (backEndRatio <= 43) {
            lenderPreference = 'Good';
          } else if (backEndRatio <= 50) {
            lenderPreference = 'Fair';
          }
          document.getElementById('front-end-ratio').textContent = frontEndRatio.toFixed(0) + '%';
          document.getElementById('back-end-ratio').textContent = backEndRatio.toFixed(0) + '%';
          document.getElementById('lender-preference').textContent = lenderPreference;
          document.getElementById('your-back-end').textContent = backEndRatio.toFixed(0) + '%';
        }

        // Helper function to format currency
        function formatCurrency(amount) {
          return '$' + amount.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
        }

        // Calculate initial values
        calculateMortgage();
        calculateDTI();
      });
    </script>

    <script>
    (function(){if(!window.chatbase||window.chatbase("getState")!=="initialized"){window.chatbase=(...arguments)=>{if(!window.chatbase.q){window.chatbase.q=[]}window.chatbase.q.push(arguments)};window.chatbase=new Proxy(window.chatbase,{get(target,prop){if(prop==="q"){return target.q}return(...args)=>target(prop,...args)}})}const onLoad=function(){const script=document.createElement("script");script.src="https://www.chatbase.co/embed.min.js";script.id="RfCRY6zG0cFaXP1SpqUgu";script.domain="www.chatbase.co";document.body.appendChild(script)};if(document.readyState==="complete"){onLoad()}else{window.addEventListener("load",onLoad)}})();
    </script>
    
  </body>
</html>

